{"mappings":"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","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import '../css/styles.css';\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchPictures } from '../js/fetch-pictures';\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-more');\n\nsearchForm.addEventListener('submit', handleSearch);\nloadBtn.addEventListener('click', handleLoadMore);\n\nlet simpleLightbox = null;\nlet searchQuery = null;\nlet page = 1;\n\nasync function handleSearch(e) {\n  e.preventDefault();\n  searchQuery = e.target.elements.searchQuery.value.trim();\n  page = 1;\n  ClearMarkUp();\n  if (searchQuery === '') {\n    searchForm.reset();\n    Notiflix.Notify.warning('Please, enter a request', {\n      clickToClose: true,\n    });\n    return;\n  }\n\n  try {\n    const {\n      hits: pictures,\n      totalHits: totalQuantity,\n      total: quantity,\n    } = await fetchPictures(searchQuery, page);\n    if (quantity === 0) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.',\n        {\n          clickToClose: true,\n        }\n      );\n      return;\n    }\n    Notiflix.Notify.success(`Hooray! We found ${totalQuantity} images.`, {\n      clickToClose: true,\n    });\n    createCards(pictures);\n    window.addEventListener('scroll', handleScrollPage);\n    simpleLightbox = new SimpleLightbox('.gallery a', {\n      // navText: ['&#11178;', '&#11179;'],\n      navText: ['&#8656;', '&#8658;'],\n      //   closeText: \"&#10015;\", краще не розкоментовувати :)\n      closeText: '&#10803',\n      showCounter: false,\n    });\n    if (totalQuantity < page * 40) {\n      window.removeEventListener('scroll', handleScrollPage);\n      loadBtn.classList.add('is-hidden');\n      Notiflix.Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\",\n        { clickToClose: true }\n      );\n      createEndMessage();\n      return;\n    }\n    // loadBtn.classList.remove('is-hidden');\n  } catch {\n    Notiflix.Notify.failure('Please try again later.'),\n      {\n        clickToClose: true,\n      };\n  }\n\n  console.log(searchQuery);\n}\n\nfunction handleScrollPage() {\n  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n\n  console.log({ scrollTop, scrollHeight, clientHeight });\n\n  if (clientHeight + scrollTop >= scrollHeight - 5) {\n    handleLoadMore();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  try {\n    const {\n      hits: pictures,\n      totalHits: totalQuantity,\n      total: quantity,\n    } = await fetchPictures(searchQuery, page);\n    createCards(pictures);\n    simpleLightbox.refresh();\n    autoScrollPage();\n\n    if (totalQuantity < page * 40) {\n      window.removeEventListener('scroll', handleScrollPage);\n      loadBtn.classList.add('is-hidden');\n      createEndMessage();\n      return;\n    }\n  } catch (err) {\n    console.log(err);\n    Notiflix.Notify.failure('Please try again later.'),\n      {\n        clickToClose: true,\n      };\n  }\n}\nfunction createEndMessage() {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    `\n    <p class=\"end-message\">\n      The end :)\n    </p>\n    `\n  );\n}\n\nfunction createCards(data) {\n  data.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      gallery.insertAdjacentHTML(\n        'beforeend',\n        `\n        <a href=\"${largeImageURL}\">\n          <div class=\"photo-card\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                ${downloads}\n              </p>\n            </div>\n          </div>\n        </a>\n        `\n      );\n    }\n  );\n}\n\nfunction autoScrollPage() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction ClearMarkUp() {\n  gallery.innerHTML = '';\n}\n"],"names":["$bpxeT","parcelRequire","$93b54f497d416715$var$searchForm","document","querySelector","$93b54f497d416715$var$gallery","$93b54f497d416715$var$loadBtn","addEventListener","e","$93b54f497d416715$var$_handleSearch","apply","this","arguments","$93b54f497d416715$var$handleLoadMore","$93b54f497d416715$var$simpleLightbox","$93b54f497d416715$var$searchQuery","$93b54f497d416715$var$page","$parcel$interopDefault","$2TvXO","mark","_callee","ref","pictures","totalQuantity","preventDefault","target","elements","searchQuery","value","trim","$93b54f497d416715$var$ClearMarkUp","reset","$6JpON","Notify","warning","clickToClose","$gouQe","fetchPictures","_ctx","sent","hits","totalHits","total","failure","success","concat","$93b54f497d416715$var$createCards","window","$93b54f497d416715$var$handleScrollPage","$5IjG7","navText","closeText","showCounter","removeEventListener","classList","add","$93b54f497d416715$var$createEndMessage","console","log","_documentElement","documentElement","scrollTop","scrollHeight","clientHeight","$93b54f497d416715$var$_handleLoadMore","refresh","$93b54f497d416715$var$autoScrollPage","t0","insertAdjacentHTML","data","map","param","webformatURL","largeImageURL","tags","likes","views","comments","downloads","cardHeight","firstElementChild","getBoundingClientRect","height","scrollBy","top","behavior","innerHTML"],"version":3,"file":"infinite-scroll.817fa23f.js.map"}