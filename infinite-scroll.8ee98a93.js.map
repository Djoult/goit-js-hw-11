{"mappings":"gkBAMA,MAAMA,EAAaC,SAASC,cAAc,gBACpCC,EAAUF,SAASC,cAAc,YACjCE,EAAUH,SAASC,cAAc,cAEvCF,EAAWK,iBAAiB,UAO5BC,eAA4BC,GAK1B,GAJAA,EAAEC,iBACFC,EAAcF,EAAEG,OAAOC,SAASC,YAAYC,MAAMC,OAClDC,EAAO,EA8JT,WACEZ,EAAQa,UAAY,E,CA9JpBC,GACoB,KAAhBR,EAKF,OAJAT,EAAWkB,aACXC,EAAAC,GAASC,OAAOC,QAAQ,0BAA2B,CACjDC,cAAc,IAKlB,IACE,MACEC,KAAMC,EACNC,UAAWC,EACXC,MAAOC,SACC,EAAAC,EAAAC,eAActB,EAAaM,GACrC,GAAiB,IAAbc,EAOF,YANAV,EAAAC,GAASC,OAAOW,QACd,2EACA,CACET,cAAc,IAiBpB,GAZAJ,EAAAC,GAASC,OAAOY,QAAQ,oBAAoBN,YAAyB,CACnEJ,cAAc,IAEhBW,EAAYT,GACZU,OAAO9B,iBAAiB,SAAU+B,GAClCC,EAAiB,IAAIlB,EAAAmB,GAAJ,CAAmB,aAAc,CAEhDC,QAAS,CAAC,UAAW,WAErBC,UAAW,UACXC,aAAa,IAEXd,EAAuB,GAAPZ,EAQlB,OAPAoB,OAAOO,oBAAoB,SAAUN,GACrChC,EAAQuC,UAAUC,IAAI,aACtBzB,EAAAC,GAASC,OAAOC,QACd,6DACA,CAAEC,cAAc,SAElBsB,G,CAIF,MACA1B,EAAAC,GAASC,OAAOW,QAAQ,0B,CAM1Bc,QAAQC,IAAItC,E,IAhEdL,EAAQC,iBAAiB,QAAS2C,GAElC,IAAIX,EAAiB,KACjB5B,EAAc,KACdM,EAAO,EA+DX,SAASqB,IACP,MAAMa,UAAEA,EAASC,aAAEA,EAAYC,aAAEA,GAAiBlD,SAASmD,gBAE3DN,QAAQC,IAAI,C,UAAEE,E,aAAWC,E,aAAcC,IAEnCA,EAAeF,GAAaC,EAAe,GAC7CF,G,CAIJ1C,eAAe0C,IACbjC,GAAQ,EACR,IACE,MACES,KAAMC,EACNC,UAAWC,EACXC,MAAOC,SACC,EAAAC,EAAAC,eAActB,EAAaM,GAKrC,GAJAmB,EAAYT,GACZY,EAAegB,UAuEnB,WACE,MAAQC,OAAQC,GACdpD,EAAQqD,kBAAkBC,wBAE5BtB,OAAOuB,SAAS,CACdC,IAAkB,EAAbJ,EACLK,SAAU,U,CA5EVC,GAEIlC,EAAuB,GAAPZ,EAIlB,OAHAoB,OAAOO,oBAAoB,SAAUN,GACrChC,EAAQuC,UAAUC,IAAI,kBACtBC,G,CAGF,MAAOiB,GACPhB,QAAQC,IAAIe,GACZ3C,EAAAC,GAASC,OAAOW,QAAQ,0B,EAM5B,SAASa,IACP1C,EAAQ4D,mBACN,YACA,kE,CAQJ,SAAS7B,EAAY8B,GACnBA,EAAKC,KACH,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,MAEArE,EAAQ4D,mBACN,YACA,sBACWI,kEAEKD,WAAsBE,4IAI5BC,6GAIAC,gHAIAC,iHAIAC,sFAMX,G","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import '../css/styles.css';\nimport Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchPictures } from '../js/fetch-pictures';\n\nconst searchForm = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-more');\n\nsearchForm.addEventListener('submit', handleSearch);\nloadBtn.addEventListener('click', handleLoadMore);\n\nlet simpleLightbox = null;\nlet searchQuery = null;\nlet page = 1;\n\nasync function handleSearch(e) {\n  e.preventDefault();\n  searchQuery = e.target.elements.searchQuery.value.trim();\n  page = 1;\n  ClearMarkUp();\n  if (searchQuery === '') {\n    searchForm.reset();\n    Notiflix.Notify.warning('Please, enter a request', {\n      clickToClose: true,\n    });\n    return;\n  }\n\n  try {\n    const {\n      hits: pictures,\n      totalHits: totalQuantity,\n      total: quantity,\n    } = await fetchPictures(searchQuery, page);\n    if (quantity === 0) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.',\n        {\n          clickToClose: true,\n        }\n      );\n      return;\n    }\n    Notiflix.Notify.success(`Hooray! We found ${totalQuantity} images.`, {\n      clickToClose: true,\n    });\n    createCards(pictures);\n    window.addEventListener('scroll', handleScrollPage);\n    simpleLightbox = new SimpleLightbox('.gallery a', {\n      // navText: ['&#11178;', '&#11179;'],\n      navText: ['&#8656;', '&#8658;'],\n      //   closeText: \"&#10015;\", краще не розкоментовувати :)\n      closeText: '&#10803',\n      showCounter: false,\n    });\n    if (totalQuantity < page * 40) {\n      window.removeEventListener('scroll', handleScrollPage);\n      loadBtn.classList.add('is-hidden');\n      Notiflix.Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\",\n        { clickToClose: true }\n      );\n      createEndMessage();\n      return;\n    }\n    // loadBtn.classList.remove('is-hidden');\n  } catch {\n    Notiflix.Notify.failure('Please try again later.'),\n      {\n        clickToClose: true,\n      };\n  }\n\n  console.log(searchQuery);\n}\n\nfunction handleScrollPage() {\n  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n\n  console.log({ scrollTop, scrollHeight, clientHeight });\n\n  if (clientHeight + scrollTop >= scrollHeight - 5) {\n    handleLoadMore();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  try {\n    const {\n      hits: pictures,\n      totalHits: totalQuantity,\n      total: quantity,\n    } = await fetchPictures(searchQuery, page);\n    createCards(pictures);\n    simpleLightbox.refresh();\n    autoScrollPage();\n\n    if (totalQuantity < page * 40) {\n      window.removeEventListener('scroll', handleScrollPage);\n      loadBtn.classList.add('is-hidden');\n      createEndMessage();\n      return;\n    }\n  } catch (err) {\n    console.log(err);\n    Notiflix.Notify.failure('Please try again later.'),\n      {\n        clickToClose: true,\n      };\n  }\n}\nfunction createEndMessage() {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    `\n    <p class=\"end-message\">\n      The end :)\n    </p>\n    `\n  );\n}\n\nfunction createCards(data) {\n  data.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      gallery.insertAdjacentHTML(\n        'beforeend',\n        `\n        <a href=\"${largeImageURL}\">\n          <div class=\"photo-card\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                ${downloads}\n              </p>\n            </div>\n          </div>\n        </a>\n        `\n      );\n    }\n  );\n}\n\nfunction autoScrollPage() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction ClearMarkUp() {\n  gallery.innerHTML = '';\n}\n"],"names":["$7f13665ecc617d63$var$searchForm","document","querySelector","$7f13665ecc617d63$var$gallery","$7f13665ecc617d63$var$loadBtn","addEventListener","async","e","preventDefault","$7f13665ecc617d63$var$searchQuery","target","elements","searchQuery","value","trim","$7f13665ecc617d63$var$page","innerHTML","$7f13665ecc617d63$var$ClearMarkUp","reset","$parcel$interopDefault","$7Y9D8","Notify","warning","clickToClose","hits","pictures","totalHits","totalQuantity","total","quantity","$7NwUX","fetchPictures","failure","success","$7f13665ecc617d63$var$createCards","window","$7f13665ecc617d63$var$handleScrollPage","$7f13665ecc617d63$var$simpleLightbox","$fZKcF","navText","closeText","showCounter","removeEventListener","classList","add","$7f13665ecc617d63$var$createEndMessage","console","log","$7f13665ecc617d63$var$handleLoadMore","scrollTop","scrollHeight","clientHeight","documentElement","refresh","height","cardHeight","firstElementChild","getBoundingClientRect","scrollBy","top","behavior","$7f13665ecc617d63$var$autoScrollPage","err","insertAdjacentHTML","data","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"version":3,"file":"infinite-scroll.8ee98a93.js.map"}